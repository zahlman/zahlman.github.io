## -*- coding: utf-8 -*-
<%namespace name="helper" file="index_helper.tmpl"/>
<%namespace name="math" file="math_helper.tmpl"/>
<%namespace name="comments" file="comments_helper.tmpl"/>
<%namespace name="pagination" file="pagination_helper.tmpl"/>
<%namespace name="feeds_translations" file="feeds_translations_helper.tmpl" import="*"/>
<%inherit file="base.tmpl"/>

<%block name="extra_head">
    ${parent.extra_head()}
    % if posts and (permalink == '/' or permalink == '/' + index_file):
        <link rel="prefetch" href="${posts[0].permalink()}" type="text/html">
    % endif
    ${math.math_styles_ifposts(posts)}
</%block>

<%block name="content">
    <%block name="content_header">
        ${feeds_translations.translation_link(kind)}
    </%block>
    % if 'main_index' in pagekind:
        ${front_index_header}
    % endif
    % if page_links:
        ${pagination.page_navigation(current_page, page_links, prevlink, nextlink, prev_next_links_reversed)}
    % endif
    <div class="postindex">
        % for post in posts:
            <article class="h-entry post-${post.meta('type')}" itemscope="itemscope" itemtype="http://schema.org/Article">
            <header>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    % if author_pages_generated and multiple_authors_per_post:
                        % for author in post.authors():
                            <a href="${_link('author', author)}">${author|h}</a>
                        % endfor
                    % elif author_pages_generated:
                        <a href="${_link('author', post.author())}">${post.author()|h}</a>
                    % else:
                        ${post.author()|h}
                    % endif
                    </span></p>
                    <p class="dateline">
                        <time class="published dt-published" datetime="${post.formatted_date('webiso')}" itemprop="datePublished" title="${post.formatted_date(date_format)|h}">${post.formatted_date(date_format)|h}</time>
                        % if post.updated and post.updated != post.date:
                            <span class="updated">
                                (${messages("updated")}
                                <time class="dt-updated" datetime="${post.formatted_updated('webiso')}" itemprop="dateUpdated" title="${post.formatted_updated(date_format)|h}">${post.formatted_updated(date_format)|h}</time>)
                            </span>
                        % endif
                    </p>
                    ${comments.commentline(post)}
                </div>
                <h1 class="p-name entry-title"><a href="${post.permalink()}" rel="bookmark" class="u-url">${post.title()|h}</a></h1>
            </header>
            %if index_teasers:
                <div class="p-summary entry-summary">
                    ${post.text(teaser_only=True)}
                </div>
            %else:
                <div class="e-content entry-content">
                    ${post.text(teaser_only=False)}
                </div>
            %endif
            </article>
            %if not loop.last:
                <hr>
            %endif
        % endfor
    </div>
    ${helper.html_pager()}
    ${math.math_scripts_ifposts(posts)}
</%block>

## Removed "before_content" block, used to "feature" posts.
